(function(e){function t(e,t,a){window.top.postMessage({slug:"wpcp",action:"wpcp-change-value",id:e,value:t,old_value:a},window.location.origin)}function a(e){if(e.origin!==window.parent.location.origin)return;if("object"!=typeof e.data||null===e.data||void 0===e.data.action)return;if("wpcp-select-entries"!==e.data.action)return;if("outofthebox"!==e.data.slug)return;const t=e.data.entries[0];i.find(".wpcp-folder-selector-current").val(t.entry_name),i.find(".wpcp-folder-selector-input-account").val(t.account_id).trigger("change"),i.find(".wpcp-folder-selector-input-id").val(t.entry_path).trigger("change"),i.find(".wpcp-folder-selector-input-name ").val(t.entry_name).trigger("change"),window.modal_folder_selector.close(),window.removeEventListener("message",a)}function o(t){if(e("#wpcp-modal-folder-selector").length>0)return window.modal_folder_selector.open();let a=e('<div class="wpcp-modal-header" tabindex="0">                          \n                    <a tabindex="0" class="close-button"  onclick="modal_folder_selector.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a>\n                </div>'),o=e('<div class="wpcp-modal-body" tabindex="0"></div>'),n=e('<div class="wpcp-modal-footer"><div class="wpcp-modal-buttons"></div></div>'),i=e('<div id="wpcp-modal-folder-selector" class="OutoftheBox wpcp wpcp-modal wpcp-modal80 wpcp-modal-minimal light"><div class="modal-dialog"><div class="modal-content"></div></div></div>');var c=t.clone().show();c.find(".wpcp-module").OutoftheBox(OutoftheBox_vars),o.append(c),e("#wpcp").append(i),e("#wpcp-modal-folder-selector .modal-content").append(a,o,n);var d=new RModal(document.getElementById("wpcp-modal-folder-selector"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0,afterClose(){window.removeEventListener("message",self.callback_handler)}});document.addEventListener("keydown",function(e){d.keydown(e)},!1),d.open(),window.modal_folder_selector=d}var n=null,i=null;/outofthebox/i.test(window.location.href)&&e("body").addClass("wpcp-admin"),e("#wpcp").fadeIn(),e("#wpcp").on({click:function(t){var a=e(this),o=a.data("nav-tab");if(a.hasClass("disabled"))return!1;e("a[data-nav-tab]").removeClass("bg-gray-100 text-gray-900").addClass("text-gray-600 hover:bg-gray-50 hover:text-brand-color-900"),e("[data-nav-panel]").removeClass("wpcp-tab-active").addClass("!hidden"),a.addClass("wpcp-tab-active").addClass("bg-gray-100 text-gray-900").removeClass("text-gray-600 hover:bg-gray-50 hover:text-brand-color-900"),e("[data-nav-panel='"+o+"']").addClass("wpcp-tab-active").removeClass("!hidden"),location.hash.replace("#",""),location.hash=o,window.scrollTo(0,0),window.parent.scroll(0,0)}},'a[data-nav-tab]:not(".disabled")'),location.hash&&location.hash.indexOf("TB_inline")<0?e("[data-nav-tab='"+location.hash.replace("#","")+"']").trigger("click"):e("[data-nav-tab]:first").trigger("click"),e("#wpcp").on({click:function(){var t=e(this),a=e(this).parents("[data-nav-panel]"),o=e(this).next(),n=t.hasClass("wpcp-panel-header-active");a.find(".wpcp-panel-header-opened").hide(),a.find(".wpcp-panel-header-closed").show(),a.find(".wpcp-panel-header-active").removeClass("wpcp-panel-header-active"),a.find(".wpcp-panel-accordion").slideUp(),n||(t.find(".wpcp-panel-header-opened").show(),t.find(".wpcp-panel-header-closed").hide(),t.addClass("wpcp-panel-header-active"),o.slideDown(200),o.get(0).scrollIntoView({behavior:"auto",block:"center",inline:"center"}))}},".wpcp-panel-header"),e("[data-nav-panel]").each(function(){e(this).find(".wpcp-panel-header:first").trigger("click")}),e(".wpcp-input-checkbox-button, .wpcp-input-checkbox-icon-button").on("click",function(a){var o=e(this).find('input[type="checkbox"]');o.prop("checked",!o.prop("checked")).trigger("change"),t(o.attr("id"),o.prop("checked"),!o.prop("checked"))}),e('.wpcp-input-checkbox-button input[type="checkbox"]').on("change",function(t){let a=e(this).parent(".wpcp-input-checkbox-button"),o=a.children(".wpcp-input-checkbox-button-container"),n=o.children(".wpcp-input-checkbox-button-off"),i=o.children(".wpcp-input-checkbox-button-on"),c=e(this).prop("checked");c?(a.removeClass("bg-gray-200").addClass("bg-brand-color-900"),o.removeClass("translate-x-0").addClass("translate-x-5"),n.removeClass("opacity-100 ease-in duration-200").addClass("opacity-0 ease-out duration-100"),i.removeClass("opacity-0 ease-out duration-100").addClass("opacity-100 ease-in duration-200"),e(a.data("toggle-element")).slideDown()):(a.addClass("bg-gray-200").removeClass("bg-brand-color-900"),o.addClass("translate-x-0").removeClass("translate-x-5"),n.addClass("opacity-100 ease-in duration-200").removeClass("opacity-0 ease-out duration-100"),i.addClass("opacity-0 ease-out duration-100").removeClass("opacity-100 ease-in duration-200"),e(a.data("toggle-element")).slideUp())}).trigger("change"),e('.wpcp-input-checkbox-icon-button input[type="checkbox"]').on("change",function(t){let a=e(this).parent(".wpcp-input-checkbox-icon-button"),o=e(this).prop("checked");o?a.addClass("bg-gray-50 border-brand-color-900").removeClass("bg-white"):a.removeClass("bg-gray-50 border-brand-color-900").addClass("bg-white")}).trigger("change"),e(".wpcp-input-textbox, .wpcp-input-textarea, .wpcp-input-wpeditor, .wpcp-input-hidden").on({focus:function(t){var a=e(this);a.data("old-value",a.val())},change:function(a){var o=e(this);t(o.attr("id"),o.val(),o.data("old-value"))}}),e(".wpcp-input-select").on({focus:function(t){var a=e(this);a.data("old-value",a.val())},change:function(a){var o=e(this);t(o.attr("id"),o.val(),o.data("old-value")),o.trigger("do-toggle")},"do-toggle":function(t){var a=e(this),o=a.find("option").map(function(){return e(this).data("toggle-element")}).get(),n=a.find(":selected").data("toggle-element");o.length&&(e.each(o,function(t,a){e(a).slideUp(0)}),e(n).slideDown())}}).trigger("do-toggle"),e(".wpcp-input-radio").on({focus:function(t){var a=e(this);a.data("old-value",a.val())},change:function(a){var o=e(this);t(o.attr("id"),o.val(),o.data("old-value")),o.trigger("do-toggle")},"do-toggle":function(t){var a=e(this),o=e('input[name="'+a.attr("name")+'"]').map(function(){return e(this).data("toggle-element")}).get(),n=e('input[name="'+a.attr("name")+'"]:checked').data("toggle-element");o.length&&(e.each(o,function(t,a){e(a).slideUp(0)}),e(n).slideDown())}}).trigger("do-toggle"),e(".wpcp-shareon-toggle-button").on("click",function(a){a.stopImmediatePropagation();var o=e(this).next(),n=o.val();"disabled"===n?o.val("enabled"):o.val("disabled"),t(o.attr("id"),o.val(),n),o.trigger("change")}),e(".wpcp-shareon-input").on("change",function(t){"disabled"===e(this).val()?e(this).prev().removeClass("shareon-enabled").addClass("shareon-disabled"):e(this).prev().removeClass("shareon-disabled").addClass("shareon-enabled")}),e('.wpcp-tagify[data-tagify-whitelist=""]').each(function(){new Tagify(this,{enforceWhitelist:!1,editTags:!0,pattern:/^[\p{L}\p{N}\p{M}\s\-_!@#$%^&*()+\-*\/{}\[\]\?]+$/u})}),e('.wpcp-tagify[data-tagify-whitelist="permissions"]').each(function(){let e=new Tagify(this,{enforceWhitelist:!0,editTags:!1,dropdown:{classname:"wpcp-app",enabled:0,highlightFirst:!0,closeOnSelect:!1,maxItems:20,position:"all"},whitelist:JSON.parse(WPCloudplugin_AdminUI_vars.whitelist),templates:{tag:function(e){return"<tag title='"+e.text+"' contenteditable='false' spellcheck='false' tabIndex='-1'  class="+this.settings.classNames.tag+(e.class?e.class:"")+"><x class='tagify__tag__removeBtn' role='button'></x><div><span class='tagify__tag-type'>"+e.type+"</span><span class='tagify__tag-text'>"+(void 0!==e.text?e.text:e.value)+"</span></div></tag>"},dropdownItem:function(e){return null===e.img&&(e.img="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAIAAgAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+uK0tH8Oalr7sthaPOF+82Qqj6k4FZtfQHgu0gs/C2mLAAFeBZGI7swyx/M0AeI6x4c1LQGUX9o8AbhX4ZT+IyKza+gvGNpBeeF9SS4AKLA8gJ7MoyD+Yr59oAfDE88qRRoXkchVVRkknoBXufgTQ9R0DRlt7+4WQfeSFRnyc8kbu9cJ8I9JS81y4vJFDC0jGwHszZAP5Bq9goA5vx3omo69ozW9hcLH/E8LDHm46Dd2/r614XNE8ErxSIUkQlWVhggjqDX0xXj/AMXNJSz1y3vI1Ci7jO8Duy4BP5FaAP/Z"),"<div class='tagify__dropdown__item' value='"+e.value+"' role='option'><img onerror='this.style.visibility=\"hidden\"' src='"+e.img+"'><span class='tagify__tag-type'>"+e.type+"</span><span>"+e.text+"</span></div>"},dropdownFooter(e){var t=e.length-this.settings.dropdown.maxItems;return t>0?"<footer class='tagify__dropdown__footer'>"+t+" more items. Refine your search</footer>":""}}});e.on("change",function(t){var a=e.value,o=a.find(e=>"all"===e.value||"none"===e.value);o&&(e.removeAllTags(),e.addTags([o]))})}),tippy(".wpcp_help_tooltip",{allowHTML:!0,interactive:!0}),e(".ddslickbox").each(function(){var t=e(this);t.ddslick({width:"598px",background:"#f4f4f4",onSelected:function(t){var a=e(t.selectedItem).closest(".dd-container").next();a.val()!==t.selectedData.value&&a.val(t.selectedData.value).trigger("change")}})}),e(".wpcp-input-codemirror").each(function(){let t=e(this);window.setTimeout(function(){let a,o=wp.codeEditor.initialize(t);o.codemirror.setSize("100%",parseFloat(20*t.get(0).rows)),o.codemirror.on("change",function(t,o){a&&clearTimeout(a),a=setTimeout(function(t){t.state.lint?0===t.state.lint.marked.length&&(t.save(),e(t.getTextArea()).trigger("change")):(t.save(),e(t.getTextArea()).trigger("change"))},1500,t)})},1e3)}),e("#wpcp").on({click:function(t){i=e(this).parents(".wpcp-folder-selector"),o(i.find(".wpcp-folder-selector-embed")),window.addEventListener("message",a)}},".wpcp-folder-selector-button, .wpcp-folder-selector-current"),e("#wpcp").on({click:function(t){i=e(this).parents(".wpcp-folder-selector"),i.find(".wpcp-folder-selector-current").val(""),i.find(".wpcp-folder-selector-input-account").val("").trigger("change"),i.find(".wpcp-folder-selector-input-id").val("").trigger("change"),i.find(".wpcp-folder-selector-input-name ").val("").trigger("change")}},".wpcp-folder-clear-button"),window.showNotification=function(t,a){var o=e("#wpcp-notification");if(t){a=a||o.find("p.wpcp-notification-success").data("default-text");o.find(".wpcp-notification-success").show(),o.find("p.wpcp-notification-success").html(a),o.find(".wpcp-notification-failed").hide()}else{a=a||o.find("p.wpcp-notification-failed").data("default-text");o.find(".wpcp-notification-failed").show(),o.find("p.wpcp-notification-failed").html(a),o.find(".wpcp-notification-success").hide()}clearTimeout(n),o.fadeIn(),n=window.setTimeout(function(){o.fadeOut()},3e3)},window.hideNotifications=function(){var t=e("#wpcp-notification");t.fadeOut(),clearTimeout(n)},e("#wpcp").on({click:function(t){e(this).parents(".wpcp-dropdown-menu").find(".wpcp-dropdown-menu-content").fadeIn(),t.stopPropagation()}},".wpcp-dropdown-menu button"),e("body").on({click:function(t){e(".wpcp-dropdown-menu-content").hide()}}),e("#wpcp").on({click:function(t){e(e(this).data("dialog-id")).fadeIn()}},".wpcp-modal-open-dialog"),e("#wpcp").on({click:function(t){e(this).closest(".account-dialog-step").hide(),e(this).closest(".account-dialog-step").prev().show()}},".wpcp-dialog-back"),e("#wpcp").on({click:function(t){e(this).closest(".account-dialog-step").hide(),e(this).closest(".account-dialog-step").next().show()}},".wpcp-dialog-next"),e("#wpcp").on({click:function(t){e(this).parents(".wpcp-dialog").fadeOut()}},".wpcp-dialog-close"),e("#wpcp").on({click:function(t){var a=e(this).parents(".wpcp-dialog");a.fadeOut(null,function(){a.remove()})}},".wpcp-dialog-destroy"),e("#wpcp").on({click:function(t){var a=e(this).parent().parent().find(".wpcp-module");return window.postMessage({slug:"outofthebox",action:"wpcp-select-entries",entries:[{entry_id:a.attr("data-id"),entry_path:decodeURIComponent(a.attr("data-path")),entry_name:a.find(".wpcp-breadcrumb li:last").text(),account_id:a.attr("data-account-id")}]},window.location.origin),t.stopPropagation(),!0}},".wpcp-dialog-entry-select")})(jQuery);